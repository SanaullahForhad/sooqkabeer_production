<!DOCTYPE html>
<html lang="{{ session.get('lang', 'en') }}" dir="{{ 'rtl' if session.get('lang') == 'ar' else 'ltr' }}">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{ gettext('My Orders') }} - SooqFresh</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
    <style>
        .orders-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        .page-header {
            background: linear-gradient(135deg, #4CAF50 0%, #2E7D32 100%);
            color: white;
            padding: 30px;
            border-radius: 10px;
            margin-bottom: 30px;
            text-align: center;
        }
        .orders-table {
            width: 100%;
            background: white;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            margin-bottom: 30px;
        }
        .orders-table th {
            background: #f8f9fa;
            padding: 15px;
            text-align: left;
            font-weight: 600;
            color: #333;
            border-bottom: 2px solid #e9ecef;
        }
        .orders-table td {
            padding: 12px 15px;
            border-bottom: 1px solid #e9ecef;
        }
        .orders-table tr:hover {
            background: #f8f9fa;
        }
        .total-amount {
            font-size: 18px;
            font-weight: bold;
            color: #2E7D32;
            padding: 15px;
            background: #d4edda;
            border-radius: 5px;
            text-align: right;
        }
        .nav-buttons {
            display: flex;
            gap: 10px;
            margin: 20px 0;
            justify-content: center;
        }
        .nav-btn {
            padding: 10px 20px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            text-decoration: none;
            display: inline-block;
            font-weight: 500;
        }
        .btn-primary {
            background: #667eea;
            color: white;
        }
        .btn-success {
            background: #4CAF50;
            color: white;
        }
        .btn-secondary {
            background: #6c757d;
            color: white;
        }
        .empty-state {
            text-align: center;
            padding: 50px;
            color: #666;
            background: white;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }
        .order-id {
            font-family: monospace;
            background: #f8f9fa;
            padding: 2px 6px;
            border-radius: 3px;
        }
    </style>
</head>
<body>
    <div class="orders-container">
        <div class="page-header">
            <h1>{{ gettext('My Orders') }}</h1>
            <p>{{ gettext('Order History') }} - {{ session.username }}</p>
            <div class="nav-buttons">
                <a href="{{ url_for('products') }}" class="nav-btn btn-success">{{ gettext('Continue Shopping') }}</a>
                {% if session.role == 'vendor' %}
                    <a href="{{ url_for('vendor_dashboard') }}" class="nav-btn btn-primary">{{ gettext('Vendor Dashboard') }}</a>
                {% elif session.role == 'admin' %}
                    <a href="{{ url_for('admin') }}" class="nav-btn btn-primary">{{ gettext('Admin Panel') }}</a>
                {% endif %}
                <a href="{{ url_for('logout') }}" class="nav-btn btn-secondary">{{ gettext('Logout') }}</a>
            </div>
        </div>
        
        {% if orders %}
        <table class="orders-table">
            <thead>
                <tr>
                    <th>{{ gettext('Order ID') }}</th>
                    <th>{{ gettext('Product Name') }}</th>
                    <th>{{ gettext('Quantity') }}</th>
                    <th>{{ gettext('Unit Price') }}</th>
                    <th>{{ gettext('Total') }}</th>
                    <th>{{ gettext('Date & Time') }}</th>
                </tr>
            </thead>
            <tbody>
                {% set grand_total = namespace(value=0) %}
                {% for order in orders %}
                <tr>
                    <td><span class="order-id">#{{ order[0] }}</span></td>
                    <td>
                        {% if session.get('lang') == 'ar' %}
                            {{ order[2] if order[2] else order[1] }}
                        {% else %}
                            {{ order[1] }}
                        {% endif %}
                    </td>
                    <td>{{ "%.2f"|format(order[3]) }} KG</td>
                    <td>{{ "%.3f"|format(order[4]) }} KD</td>
                    <td>{{ "%.3f"|format(order[5]) }} KD</td>
                    <td>{{ order[6] }}</td>
                </tr>
                {% set grand_total.value = grand_total.value + order[5] %}
                {% endfor %}
            </tbody>
        </table>
        
        <div class="total-amount">
            {{ gettext('Grand Total') }}: {{ "%.3f"|format(grand_total.value) }} KD
        </div>
        {% else %}
        <div class="empty-state">
            <h2>üõí</h2>
            <h3>{{ gettext('No Orders Found') }}</h3>
            <p>{{ gettext('You have not placed any orders yet.') }}</p>
            <a href="{{ url_for('products') }}" class="nav-btn btn-success" style="margin-top: 20px;">
                {{ gettext('Start Shopping') }}
            </a>
        </div>
        {% endif %}
    </div>
    
    <script>
        // Print order summary
        function printOrderSummary() {
            window.print();
        }
        
        // Add print button if there are orders
        {% if orders %}
        document.addEventListener('DOMContentLoaded', function() {
            const printBtn = document.createElement('button');
            printBtn.innerHTML = 'üñ®Ô∏è {{ gettext("Print Summary") }}';
            printBtn.style.position = 'fixed';
            printBtn.style.bottom = '20px';
            printBtn.style.right = '20px';
            printBtn.style.padding = '10px 20px';
            printBtn.style.background = '#6c757d';
            printBtn.style.color = 'white';
            printBtn.style.border = 'none';
            printBtn.style.borderRadius = '5px';
            printBtn.style.cursor = 'pointer';
            printBtn.style.zIndex = '1000';
            printBtn.onclick = printOrderSummary;
            document.body.appendChild(printBtn);
        });
        {% endif %}
    </script>
</body>
</html>
