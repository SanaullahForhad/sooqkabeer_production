<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Dashboard - SooqKabeer</title>
    <style>
        :root {
            --primary: #3498db;
            --secondary: #2ecc71;
            --danger: #e74c3c;
            --warning: #f39c12;
            --dark: #2c3e50;
            --light: #ecf0f1;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; }
        body { background: #f5f7fa; min-height: 100vh; }

        /* Header & Sidebar */
        .admin-header { background: white; padding: 20px 30px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); display: flex; justify-content: space-between; align-items: center; }
        .logo h1 { color: var(--dark); font-size: 24px; }
        .logo span { color: var(--primary); font-weight: bold; }
        .sidebar { width: 250px; background: var(--dark); color: white; min-height: calc(100vh - 80px); position: fixed; left: 0; top: 80px; padding-top: 20px; }
        .sidebar-menu { list-style: none; }
        .menu-item { padding: 15px 25px; display: flex; align-items: center; gap: 15px; cursor: pointer; transition: all 0.3s; text-decoration: none; color: white; }
        .menu-item:hover { background: rgba(255,255,255,0.1); }
        .menu-item.active { background: var(--primary); border-left: 4px solid var(--secondary); }

        /* Main Content */
        .main-content { margin-left: 250px; padding: 30px; min-height: calc(100vh - 80px); }
        .welcome-banner { background: linear-gradient(135deg, var(--primary) 0%, #2980b9 100%); color: white; padding: 30px; border-radius: 15px; margin-bottom: 30px; }
        
        /* Stats Grid */
        .stats-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(220px, 1fr)); gap: 20px; margin-bottom: 30px; }
        .stat-card { background: white; padding: 20px; border-radius: 15px; box-shadow: 0 5px 15px rgba(0,0,0,0.1); text-align: center; }
        .stat-number { font-size: 28px; font-weight: bold; color: var(--dark); margin: 10px 0; }

        /* Table Design */
        .dashboard-section { background: white; padding: 25px; border-radius: 15px; box-shadow: 0 5px 15px rgba(0,0,0,0.1); overflow-x: auto; }
        table { width: 100%; border-collapse: collapse; min-width: 800px; }
        th { background: #f8f9fa; padding: 15px; text-align: left; color: var(--dark); border-bottom: 2px solid #eee; }
        td { padding: 12px 15px; border-bottom: 1px solid #eee; font-size: 14px; }
        
        .status-badge { padding: 5px 12px; border-radius: 20px; font-size: 11px; font-weight: bold; text-transform: uppercase; }
        .status-pending { background: #fff3cd; color: #856404; }
        .status-completed { background: #d4edda; color: #155724; }
        
        .ref-code { color: #e67e22; font-weight: bold; font-family: monospace; }

        /* Responsive */
        @media (max-width: 768px) {
            .sidebar { width: 100%; position: static; min-height: auto; }
            .main-content { margin-left: 0; padding: 15px; }
        }
    </style>
</head>
<body>
    <div class="admin-header">
        <div class="logo"><h1>Sooq<span>Kabeer</span> Admin</h1></div>
        <div class="user-info">
            <span style="font-weight: bold;">{{ session.get('admin_username', 'Admin') }}</span>
            <a href="/admin/logout" style="color: var(--danger); text-decoration: none; margin-left: 15px;">Logout</a>
        </div>
    </div>

    <div class="sidebar">
        <ul class="sidebar-menu">
            <li><a href="/admin/dashboard" class="menu-item active">ğŸ“Š Dashboard</a></li>
            <li><a href="/admin/products" class="menu-item">ğŸ“¦ Products</a></li>
            <li><a href="/admin/orders" class="menu-item">ğŸ“‹ Orders</a></li>
            <li><a href="/admin/commissions" class="menu-item">ğŸ’° Commissions</a></li>
            <li><a href="/admin/users" class="menu-item">ğŸ‘¥ Users</a></li>
            <li><a href="/admin/settings" class="menu-item">âš™ï¸ Settings</a></li>
        </ul>
    </div>

    <div class="main-content">
        <div class="welcome-banner">
            <h1 class="welcome-title">Welcome back, Admin! ğŸ‘‹</h1>
            <p>Your business is looking great today.</p>
        </div>

        <div class="stats-grid">
            <div class="stat-card"><div>ğŸ“¦</div><div class="stat-number">{{ total_products }}</div><div class="stat-label">Products</div></div>
            <div class="stat-card"><div>ğŸ“‹</div><div class="stat-number">{{ total_orders }}</div><div class="stat-label">Orders</div></div>
            <div class="stat-card"><div>ğŸ‘¥</div><div class="stat-number">{{ total_users }}</div><div class="stat-label">Users</div></div>
            <div class="stat-card"><div>ğŸ’°</div><div class="stat-number">{{ "%.2f"|format(total_commissions) if total_commissions else '0.00' }} KD</div><div class="stat-label">Commissions</div></div>
        </div>

        <div class="dashboard-section">
    <h2 style="margin-bottom: 20px;">ğŸ“‹ Recent Orders</h2>
    <table>
        <thead>
            <tr>
                <th>Order #</th>
                <th>Customer</th>
                <th>Referrer</th>
                <th>Amount</th>
                <th>Status</th>
                <th>Date</th>
                <th>Action</th>
            </tr>
        </thead>
        <tbody>
            {% for order in recent_orders %}
            <tr>
                <td>#{{ order['id'] }}</td>
                <td><strong>{{ order['customer_name'] }}</strong></td>
                <td>
                    <span class="ref-code" style="color: #e67e22; font-weight: bold;">
                        {{ order['referrer_id_code'] if order['referrer_id_code'] else 'Direct' }}
                    </span>
                </td>
                <td>{{ order['total_price'] }} KD</td>
                <td>
                    <span class="status-badge status-{{ order['status'] }}">
                        {{ order['status']|title }}
                    </span>
                </td>
                <td>{{ order['created_at'][:10] if order['created_at'] else 'N/A' }}</td>
                <td>
                    <a href="/admin/order/{{ order['id'] }}" style="color: #3498db; text-decoration: none; font-weight: bold;">
                        View
                    </a>
                </td>
            </tr>
            {% endfor %}
            
            {% if not recent_orders %}
            <tr>
                <td colspan="7" style="text-align: center; padding: 30px; color: #7f8c8d;">
                    No recent orders found
                </td>
            </tr>
            {% endif %}
        </tbody>
    </table>
</div>

